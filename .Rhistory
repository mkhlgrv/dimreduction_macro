y =predict(acc_m, newdata = acc_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newdata = X.mat_full),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
todel <- c(1,8,11,38, 43:51, 56, 59, 60, 62:66)
df.mat_full <- df_full[,-todel] %>% na.omit()
for(i in 1:ncol(df.mat_full)){
df.mat_full[,i] %<>% diff.xts(4,log = TRUE)
}
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
# lasso----
tc <- trainControl(method = "timeslice", initialWindow = 40,horizon = 10,fixedWindow = TRUE)
glm.out <- train(x=X.train,
y=y.train,
method = "glmnet",
metric = "RMSE",trControl = tc,
tuneGrid = expand.grid(.alpha = c(1),.lambda = seq(0.05,0.0001,length = 300)))
plot(glm.out)
best_lam <- glm.out$bestTune[1,2]
lasso_best <- glmnet(X.train,y.train, alpha = 1, lambda = c(best_lam,best_lam/2,best_lam/3, best_lam/4, best_lam/5))
pred <- predict(lasso_best,newx = X.test) #%>% melt
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
predict(lasso_best, newx = X.mat_full)
predict(lasso_best, newx = X.mat_full)[,1]
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full)[,1],
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
for (i in 1:ncol(pred)){
RMSE(pred[,i], y.test %>% as.numeric) %>% print
}
pred <- predict(lasso_best,newx = X.test) #%>% melt
for (i in 1:ncol(pred)){
RMSE(pred[,i], y.test %>% as.numeric) %>% print
}
todel <- c(1,8,11,38, 43:51, 56, 59, 60, 62,65:66)# for accelerator
df.mat_full <- df_full[,-todel] %>% na.omit()
for(i in 1:ncol(df.mat_full)){
df.mat_full[,i] %<>% diff.xts(4,log = TRUE)
}
df.mat_full%<>% na.omit()
X.mat_full <- model.matrix(investment_current~0+., data = df.mat_full)
X.train <- X.mat_full[1:56,]
X.test <- X.mat_full[57:72,]
y.train <- df.mat_full$investment_current["2001-01/2014-12"] %>% as.numeric
y.test <- df.mat_full$investment_current["2015-01/2018-12"]
acc_m <- lm(investment_current~gdp_current+gdp_lag+investment_lag,
data = cbind(X.train,
data.frame(investment_current= y.train)))
acc_df <- cbind(rbind(X.train, X.test),data.frame(investment_current= c(y.train, y.test)))
acc_m %>% summary
pred <- predict(acc_df, X.test)
pred <- predict(acc_df, cbind(X.test,
data.frame(investment_current= y.test)))
y.test <- df.mat_full$investment_current["2015-01/2018-12"]%>% as.numeric
pred <- predict(acc_df, cbind(X.test,
data.frame(investment_current= y.test)))
acc_m <- lm(investment_current~gdp_current+gdp_lag+investment_lag,
data = cbind(X.train,
data.frame(investment_current= y.train)))
acc_m %>% summary
pred <- predict(acc_df, cbind(X.test,
data.frame(investment_current= y.test)))
pred <- predict(acc_df, newdata = cbind(X.test,
data.frame(investment_current= y.test)))
pred <- predict(acc_df, newdata = cbind(X.test, data.frame(investment_current= y.test)))
pred <- predict(acc_m, newdata = cbind(X.test, data.frame(investment_current= y.test)))
RMSE(pred, y.test)
ggplot()+geom_line(aes(x = row.names(acc_df) %>% as.yearqtr, y = acc_df$investment_current))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
y =predict(acc_m, newdata = acc_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
acc_plot <- ggplot()+geom_line(aes(x = row.names(acc_df) %>% as.yearqtr, y = acc_df$investment_current))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
y =predict(acc_m, newdata = acc_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full)[,1],
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
todel <- c(1,8,11,38, 43:51, 56, 59, 60, 62:66)
df.mat_full <- df_full[,-todel] %>% na.omit()
for(i in 1:ncol(df.mat_full)){
df.mat_full[,i] %<>% diff.xts(4,log = TRUE)
}
df.mat_full%<>% na.omit()
X.mat_full <- model.matrix(investment_current~0+., data = df.mat_full)
X.train <- X.mat_full[1:56,]
X.test <- X.mat_full[57:72,]
y.train <- df.mat_full$investment_current["2001-01/2014-12"] %>% as.numeric
y.test <- df.mat_full$investment_current["2015-01/2018-12"]%>% as.numeric
# lasso----
tc <- trainControl(method = "timeslice", initialWindow = 40,horizon = 10,fixedWindow = TRUE)
glm.out <- train(x=X.train,
y=y.train,
method = "glmnet",
metric = "RMSE",trControl = tc,
tuneGrid = expand.grid(.alpha = c(1),.lambda = seq(0.05,0.0001,length = 300)))
plot(glm.out)
best_lam <- glm.out$bestTune[1,2]
lasso_best <- glmnet(X.train,y.train, alpha = 1, lambda = c(best_lam,best_lam/2,best_lam/3, best_lam/4, best_lam/5))
pred <- predict(lasso_best,newx = X.test) #%>% melt
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full)[,1],
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
for (i in 1:ncol(pred)){
RMSE(pred[,i], y.test %>% as.numeric) %>% print
}
# adaptive lasso ----
# сначала ridge
train.ridge <- train(x=X.train,
y=y.train,
method = "glmnet",
metric = "RMSE",trControl = tc,
tuneGrid = expand.grid(.alpha = c(0),.lambda = seq(0.05,0.0001,length = 300)))
m_ridge <- glmnet(X.train, y.train, alpha = 0, lambda = train.ridge$bestTune[1,2])
pred <- predict(m_ridge,newx = X.test)
for (i in 1:ncol(pred)){
RMSE(pred[,i], y.test) %>% print
}
w3 <- 1/abs(as.numeric(coef(m_ridge))
[1:(ncol(X.train))] )^0.5 ## Using gamma = 1
w3[which(w3 == Inf)] <- 999999999 ## Replacing values estimated as Infinite for 999999999
m_ada <- glmnet(X.train, y.train, alpha = 1, lambda = best_lam, penalty.factor = w3)
pred <- predict(m_ada,newx = X.test)# %>% melt
predict(m_ada, type="coef")
for (i in 1:ncol(pred)){
RMSE(pred[,i], y.test) %>% print
}
# post-lasso
nzvars <- predict(lasso_best, type = "nonzero") %>% .[[1]]
train_post <- as.data.frame(X.train) %>%
select(nzvars) %>%
mutate(y = y.train)
test_post <-  as.data.frame(X.test) %>%
select(nzvars) %>%
mutate(y = 0)
m_post <- lm(y~., data = train_post)
m_post %>% summary
nznames <- colnames(X.mat_full[,nzvars])
lasso_neocl_df <- df_full[,c(nznames,colnames(df_full)[c(42,59:60,61)])]
for(i in 1:ncol(lasso_neocl_df)){
lasso_neocl_df[,i] <- diff.xts(lasso_neocl_df[,i],4, log = TRUE)
}
lasso_neocl_df %<>% .['2001-01/2018-12']
lasso_neocl_df %<>% as.data.frame()
lasso_neoc_m <- lm(investment_current~., data = lasso_neocl_df[1:56,])
lasso_neoc_m %>% summary
neocl_m <- lm(investment_current~
pyc+pyc_lag+
depr , data = lasso_neocl_df[1:56,])
neocl_m %>% summary()
lasso_neoc_m %>% resid %>% qqPlot()
neocl_m%>% resid %>% qqPlot()
ggplot()+geom_line(aes(x = row.names(lasso_neoc_m$model) %>% as.yearqtr, y = lasso_neoc_m$model[,1]))+
geom_line(aes(x = row.names(lasso_neoc_m$model) %>% as.yearqtr, y =lasso_neoc_m$fitted.values, color = "lasso"))+
geom_line(aes(x = row.names(neocl_m$model) %>% as.yearqtr, y =neocl_m$fitted.values, color = "necolassical"))
ggplot()+geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr, y = lasso_neocl_df$investment_current))+
# geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = lasso_neocl_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(neocl_m, newdata = lasso_neocl_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
ggplot()+geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr, y = lasso_neocl_df$investment_current))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(lasso_neoc_m, newdata = lasso_neocl_df),
color = "lasso"))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(neocl_m, newdata = lasso_neocl_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
pred <- predict(lasso_neoc_m,newdata = lasso_neocl_df[57:72,])
pred <- predict(neocl_m,newdata = lasso_neocl_df[57:72,])
RMSE(pred, lasso_neocl_df[57:72,"investment_current"]) %>% print
RMSE(pred, y.test) %>% print
pred <- predict(lasso_neoc_m,newdata = lasso_neocl_df[57:72,])
RMSE(pred, y.test) %>% print
nznames <- colnames(X.mat_full[,nzvars])
lasso_tobin_df <- df_full[,c(nznames,colnames(df_full)[c(42,57,65:66)])]
for(i in 1:ncol(lasso_tobin_df)){
lasso_tobin_df[,i] <- diff.xts(lasso_tobin_df[,i],4, log = TRUE)
}
lasso_tobin_df %<>% .['2001-01/2018-12']
lasso_tobin_df %<>% as.data.frame()
lasso_q_m <- lm(investment_current~., data = lasso_tobin_df[1:56,])
lasso_q_m %>% summary
tobin_m <- lm(investment_current~qcap+qcap_lag+qcap_lag2, data = lasso_tobin_df[1:56,])
tobin_m %>% summary()
confint(tobin_m)
coeftest(tobin_m,vcov. = vcovHC(tobin_m))
confint(lasso_q_m)
coeftest(lasso_q_m,vcov. = vcovHC(lasso_q_m))
lasso_q_m %>% resid %>% qqPlot()
ggplot()+geom_line(aes(x = row.names(lasso_tobin_df) %>% as.yearqtr, y = lasso_tobin_df$investment_current))+
geom_line(aes(x = row.names(lasso_tobin_df) %>% as.yearqtr,
y =predict(lasso_q_m, newdata = lasso_tobin_df),
color = "lasso"))+
geom_line(aes(x = row.names(lasso_tobin_df) %>% as.yearqtr,
y =predict(tobin_m, newdata = lasso_tobin_df),
color = "tobin"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
pred <- predict(lasso_q_m,newdata = lasso_tobin_df[57:72,])
pred <- predict(tobin_m,newdata = lasso_tobin_df[57:72,])
RMSE(pred, lasso_tobin_df[57:72,"investment_current"]) %>% print
pred <- predict(lasso_q_m,newdata = lasso_tobin_df[57:72,])
RMSE(pred, lasso_tobin_df[57:72,"investment_current"]) %>% print
lasso_ar_df <- df_full[,c(nznames,colnames(df_full)[c(42,64)])]
for(i in 1:ncol(lasso_ar_df)){
lasso_ar_df[,i] <- diff.xts(lasso_ar_df[,i],4, log = TRUE)
}
lasso_ar_df %<>% .['2001-01/2018-12']
lasso_ar_df %<>% as.data.frame()
ar_m <- lm(investment_current~., data = lasso_ar_df)
ar_m %>% summary
ggplot()+geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr, y = lasso_ar_df$investment_current))+
geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr,
y =predict(ar_m, newdata = lasso_ar_df),
color = "lasso"))+
# geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr,
#               y =predict(tobin_m, newdata = lasso_ar_df),
#               color = "tobin"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
pred <- predict(ar_m,newdata = lasso_ar_df[57:72,])
RMSE(pred, lasso_ar_df[57:72,"investment_current"]) %>% print
ggplot()+geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr, y = lasso_ar_df$investment_current))+
geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr,
y =predict(ar_m, newdata = lasso_ar_df),
color = "lasso"))+
# geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr,
#               y =predict(tobin_m, newdata = lasso_ar_df),
#               color = "tobin"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
pred <- predict(ar_m,newdata = lasso_ar_df[57:72,])
RMSE(pred, lasso_ar_df[57:72,"investment_current"]) %>% print
# spike and slab----
m_ss <- spikeslab(x = X.train, y = y.train, n.iter2 = 10000)
m_ss %>% print
m_ss$summary
m_ss$model %>% melt
R2_Score(pred,y.test) %>% print
ss_prob <-  1:ncol(X.train) %>% map_dfr(function(i){
prob <-sum(m_ss$model %>% melt %>%.$value==i)/10000
data.frame(name = colnames(X.train)[i], num = i, prob=prob)
})
RMSE(predict(m_ss, newdata = X.test)$yhat.gnet,y.test) %>% print
RMSE(predict(m_ss, newdata = X.test)$yhat.gnet,y.test) %>% print
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_ss, newdata = X.mat_full)$yhat.gnet,
color = "ss"))+
# geom_line(aes(x = row.names(lasso_ar_df) %>% as.yearqtr,
#               y =predict(tobin_m, newdata = lasso_ar_df),
#               color = "tobin"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
tc <- trainControl(method="timeslice", initialWindow = 40,fixedWindow = TRUE, horizon = 10)
tunegrid <- expand.grid(.mtry=seq(1,10))
rf.out <- train(x = X.train,
y = y.train,
method = "rf",
metric = "RMSE",
trControl = tc,
tuneGrid = tunegrid)
bestmtry <- rf.out$bestTune[1,1]
print(bestmtry)
m_rf <- randomForest(x = X.train, y = y.train, mtry = bestmtry)
pred <- y.pred.ts <- predict(m_rf, newdata = X.test) %>%
as.numeric
RMSE(pred,y.test) %>% print
acc_plot <- ggplot()+geom_line(aes(x = row.names(acc_df) %>% as.yearqtr, y = acc_df$investment_current))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
y =predict(acc_m, newdata = acc_df),
color = "Модель акселератора"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed") +
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
source('~/GitHub/hds_macro/lib.R', echo=TRUE)
acc_plot <- ggplot()+geom_line(aes(x = row.names(acc_df) %>% as.yearqtr, y = acc_df$investment_current))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
y =predict(acc_m, newdata = acc_df),
color = "Модель акселератора"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed") +
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
acc_plot
acc_plot <- ggplot()+geom_line(aes(x = row.names(acc_df) %>% as.yearqtr, y = acc_df$investment_current))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
y =predict(acc_m, newdata = acc_df),
color = "Акселератор"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed") +
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
acc_plot
ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full)[,1],
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")
lasso_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(lasso_best, newx = X.mat_full)[,1],
color = "LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
lasso_p
ridge_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_ridge, newx = X.mat_full)[,1],
color = "Ridge"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
ridge_p
ada_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
# geom_line(aes(x = row.names(acc_df) %>% as.yearqtr,
#                             y =predict(lasso_neoc_m, newdata = acc_df),
#                             color = "lasso"))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_ada, newx = X.mat_full)[,1],
color = "Ridge"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
ada_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_ada, newx = X.mat_full)[,1],
color = "Adpative LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
ada_p
post_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_post, newx = X.mat_full)[,1],
color = "Post-LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
post_p
predict(m_post, newx = X.mat_full)
post_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_post, newx = X.mat_full),
color = "Post-LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
post_p
predict(m_post, newx = X.mat_full)
row.names(X.mat_full) %>% as.yearqtr
ow.names(X.mat_full) %>% as.yearqt
row.names(X.mat_full) %>% as.yearqt
row.names(X.mat_full) %>% as.yearqtr
predict(m_ada, newx = X.mat_full)[,1]
post_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_post, newdata = X.mat_full),
color = "Post-LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
post_p
predict(m_post, newdata = X.mat_full)
post_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_post, newdata = rbind(X.train, X.test)),
color = "Post-LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
post_p
post_p <- ggplot()+geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr, y = c(y.train, y.test)))+
geom_line(aes(x = row.names(X.mat_full) %>% as.yearqtr,
y =predict(m_post, newdata = rbind(train_post, test_post)),
color = "Post-LASSO"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
post_p
ggplot()+geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr, y = lasso_neocl_df$investment_current))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(lasso_neoc_m, newdata = lasso_neocl_df),
color = "lasso"))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(neocl_m, newdata = lasso_neocl_df),
color = "neoclassical"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
ggplot()+geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr, y = lasso_neocl_df$investment_current))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(lasso_neoc_m, newdata = lasso_neocl_df),
color = "Неоклассическая + LASSO"))+
geom_line(aes(x = row.names(lasso_neocl_df) %>% as.yearqtr,
y =predict(neocl_m, newdata = lasso_neocl_df),
color = "Неоклассическая"))+
geom_vline(aes(xintercept  = as.yearqtr("2015-01-01")), color = "red",linetype="dashed")+
labs(title = "",
y = "Изменение инвестиций (log)",
x = "Дата") +
theme_bw()+
guides(colour = guide_legend(title = "Модель"))
pred <- predict(lasso_neoc_m,newdata = lasso_neocl_df[57:72,])
