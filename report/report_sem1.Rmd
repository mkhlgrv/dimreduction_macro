--- 
title: "Методы снижения размерности в данных в макроэкономике" 
author: "Михаил Гареев" 
date: '30 ноября 2018 г ' 
output: html_document 
---


## Актуальность

Одна из важных проблем, которые возникают при оценке
макроэкономических моделей, --- это малое количество наблюдений (например, стран
в мире меньше трёхсот, при этом полноценные и долгосрочные статистические данные
собраны далеко не для всех государств) и относительно большое количество
возможных параметров. Использование стандартных средств эконометрического
анализа (например, линейной регрессии) не всегда оправдано в такой ситуации. Для
получения корректных оценок необходимо каким-то образом уменьшать количество
параметров модели, т.е. сокращать размерность данных, сохраняя при этом
имеющуюся информацию. Эта работа рассматривает применение различных методов
снижения размерности в макроэкономике.

## Цель работы

* Проверка некоторых гипотез макроэкономики при помощи методов
снижения размерности в данных и создание на их основе предсказательных моделей
для макроэкономических показателей.

## Задачи работы 

* Обзор методов снижения размерности (LASSO, Post-LASSO,
Dantzig Selector и др.).

* Применение этих методов для оценки макроэкономических
зависимостей, анализ результатов, сравнение с другими методами оценивания и с
результатами, полученными ранее. 
* Построение предсказательных моделей.
* Создание процедуры мэтчинга стран на основе их макроэкономических показателей.

## Методы снижения размерности

Прежде, чем перейти к обзору методов снижения
размерности, дадим формальное определение **разреженной линейной
эконометрической модели с высокой размерностью в данных**. Так называют линейную
модель регрессии с большим количеством объясняющих переменных $p$, которое,
возможно, больше, чем размер выборки $n$, но только небольшое число $s<n$ этих
регрессоров важно для объяснения основных свойств модели. Последнее делает
возможным эффективно оценивать такую модель, находя аппроксимацию множества $s$
ненулевых коэффициентов с помощью методов снижения размерности, которые
рассматриваются в этой работе. Представим общий вид такой модели: 


\[ y_i = {x_i}^{'}
\beta_0 + \varepsilon_i, \epsilon_i \sim N(0, \sigma^2), \beta_0 \in
\mathbb{R}^p, i = 1, \dots, n, \] 

где $y_i$ --- это значения объясняемой
переменной, $x_i$ --- это значения $p$-размерной объясняющей переменной,
$\varepsilon_i$ --- значения независимых случайных ошибок в каждом наблюдении
$i$, при этом возможно, что $p \geq n$, но только $s<n$ компонентов вектора
$\beta_0$ не равны $0$.

При рассмотрении таких моделей естественным образом возникает вопрос: каким
образом можно идентфицировать ненулевые коэффициенты? Ответ помогают найти методы
снижения размерности в данных.

Рассмотрим следующую оптимизационную задачу (**Oracle Problem**):
\[ \min_{\beta \in
\mathbb{R}^p} \mathbb{E}_n\left[ (y_i - {x_i}^{'} \beta)^2 \right] + \sigma^2
\frac{\left\lVert \beta \right\rVert_0}{n}, 
\]
где $\left\lVert \beta \right\rVert_0$ --- это количество ненулевых компонентов в векторе $\beta$, некоторое обобщение понятия нормы для степени $0$. Напомним, что семейство Гёльдероых норм для вектора $x$ определется как $\left\lVert x \right\rVert_p = \sqrt[p]{\sum_i|x_i|^p}$,, где обычно $p \geq 1$.
Решение данной выше задачи омтимизации --- это результат баланса между ошибкой регрессии и количеством ненулевых коэффициентов из вектора $\beta$. Поэтому фактически применение некоторого метода снижения размерности для оценки линейной регресии сводится к нахождению оптимума для эмпирического аналога Oracle Problem.

Рассмотрим более подробно эти методы.

* Классическая оценка на основе AIC/ BIC, являющаяся решением задачи:
\[ \min_{\beta \in
\mathbb{R}^p} \sum_i=1^n \left[ (y_i - {x_i}^{'} \beta)^2 \right] +  \frac{\lambda}{n} \left\lVert \beta \right\rVert_0, 
\]
где $\lambda$ --- некоторый параметр, задающий штраф за дополнительного регрессоров. Такая оценка имеет хорошее теоретическое обоснование, но не всегда может быть вычислена при больших $n$ или $p$.

* Оценка на основе LASSO (Least Absolute shrinkage and selection operator) выглядит следующим образом:
\[
\overhat{\beta} \in \arg \min_{\beta \in
\mathbb{R}^p} \sum_i=1^n \left[ (y_i - {x_i}^{'} \beta)^2 \right] +  \frac{\lambda}{n} \left\lVert \beta \right\rVert_1,
\]
Такой метод минимизирует выпуклую функцию, и, таким образом, вычислительно он лишних регрессеров эфффективнее, чем исспользование AIC/ BIC. Параметр $\lambda$ при этом выбирается на основе некоторых алгоритмов и зависит от уровня шума в данных.
* Оценка с применением Post-LASSO. Идея метода Post-LASSO залючается в том, чтобы сначала исключить с помощью LASSO нулевых регрессоров, а после этого использовать МНК, заранее полагая исключенные параметры равными нулю. Можно показать, что при относительно низком шуме в данных и при правильной идентификации ненулевых параметров Post-LASSO помогает существенно скорректировать LASSO-оценку, но, при этом, высокий шум в данных и неправильная идентификация коэффицентов модели могут привести к смещению оценок даже по сравнению с LASSO-регрессией.

* Dantzig Selector использует следующую оптимизационную задачу для нахождения ненулевых параметров модели:
\[
\min_{\beta \in
\mathbb{R}^p} \left\lVert \beta \right\rVert_1\\
\text{s.t. } \left|x_i\beta - y_i\right| \leq \lambda \forall i = 1,\dots,n,
\]
где $\lambda$ выбирается на основе некоторых алгоритмов и тоже зависит от шума модели.

## Проверка гипотезы конвергенции с помощью методов снижения размерности.
Одним из выводов модели экономического роста Солоу является существование конвергенции, т.е. сходимости экономического развития: бедные страны растут быстрее богатых со схожими параметрами. Если это действительно так, то при расмотрении модели, где объясняемой переменной будут средние за некоторый период темпы роста реального ВВП на душу населения, а в числе объясняющих --- значение реального ВВП на душу населения в начале рассматриваемого периода, коэффициент при последнем регрессоре должен быть отрицательным. Попробуем оценить такую модель, используя данные Всемирного банка за 2012--2017 гг. 
### Однофакторная регрессия 
Сначала построим простую однофакторную регрессию, используя значения логарифма реального ВВП на душу населения в долларах 2010 г. на начала 2012 г. и среднегодовые темпы роста этого показателя в 2012--2017 г. Посмотрим на данные:

Оценим следующую модель:
\[
g_i = \alpha +\beta ln(G_i) + \varepsilon_i, \epsilon_i \sim N(0, \sigma^2),
\]
где $g_i$ --- это средний за 2012--2017 темп роста реального ВВП на душу населения, а $G_i$ --- это логафрим реального ВВП на душу населения в 2012 г. в долларах 2010 г для страны $i, i =1, \dots, 245$. Результаты оценки модели МНК даны в таблице:

<!-- таблица -->


Построим линию регрессии:

Как мы можем видеть, коэффициент при $G_i$ значим на отрицательном уровне, что говорит о существовании конвергенции. Но такая модель не объясняет большей части экономического роста, кроме того (скорее всего!), коэффициент смещён. Попробуем улучшить модель. Слабая гипотеза конвергенции говорит о том, что страны со схожими параметрами стремятся к схожим уровням богатства. Мы могли бы отобрать нужные параметры вручную из теоретических соображения (например, использовать темп роста населения и норму сбережения), но сейчас интересно посмотреть, как с такой работой справятся описанные выше методы снижения рамзерности, если использовать обширную выборку параметров на основе данных Всемирного Банка.

### LASSO-регрессия

Используем метод LASSO в R.

## Подведём итоги

Методы снижения размерности (LASSO, Post-LASSO и др.) потенциально представляют собой мощный инструмент для нахождения и проверки макроэкономических зависимостей.

## Планы на ближайшее время
* Сделать осмысленные LASSO, Post-Lasso регрессии для проверки гипотезы конвергенции на основе современных данных Всемирного банка.
* Проверить другие макроэкономические гипотезы с помощью методов снижения размерности.

## Источники

## Бонус








